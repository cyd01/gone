<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
	<title>{{.path}}</title>

	<style type="text/css">
		/* <![CDATA[ */
		#editor { 
			position: absolute;
			top: 0;
			right: 0;
			bottom: 40px;
			left: 0;
			z-index:50;
		}
		#controls {
			position: absolute;
			height: 40px;
			bottom: 0;
			left: 0;
			right: 0;
			z-index: 100;
			background-color: #eee;
		}
		#controls .control-row {
		    margin: 8px;
		}
		/* ]]> */
	</style>
</head>

<body>
	<form method="POST" action="{{.path}}">
		<input type="hidden" name="edit" value="edit" />

		<textarea name="content" rows="20">{{.content}}</textarea>
		<div id="editor"></div>

		<div id="controls">
		    <div class="control-row">
    			<input type="submit" name="save" value="Save" />
    			<input type="submit" name="saveAndReturn" value="Save and Return" />
    			{{if .edit}}
    				<a href="{{.path}}?delete">Delete</a>
    			{{end}}
			</div>
		</div>
	</form>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.2/ace.js" type="text/javascript" charset="utf-8"></script>
    <script>
        var editor = ace.edit("editor");
        editor.setTheme("ace/theme/chrome");
    
        var textarea = $('textarea[name="content"]').hide();
        editor.getSession().setValue(textarea.val());
        textarea.closest('form').submit(function() {
            textarea.val(editor.getSession().getValue());
        });
    </script>
</body>

</html>
